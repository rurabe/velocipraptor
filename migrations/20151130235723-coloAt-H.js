'use strict';

var dbm = global.dbm || require('db-migrate');
var type = dbm.dataType;

var DATA = [
  ['1',      '66.242.1.26,255.255.255.0',],
  ['1',      '68.169.22.35,255.255.255.0',],
  ['1',      '66.242.0.44,255.255.255.0',],
  ['1',      '68.169.25.23,255.255.255.0',],
  ['1',      '68.169.23.28,255.255.255.0',],
  ['1',      '89.167.203.9,255.255.255.0',],
  ['1',      '68.169.23.26,255.255.255.0',],
  ['1',      '68.169.23.21,255.255.255.0',],
  ['1',      '68.169.25.31,255.255.255.0',],
  ['1',      '68.169.24.18,255.255.255.0',],
  ['1',      '68.169.25.38,255.255.255.0',],
  ['1',      '68.169.22.47,255.255.255.0',],
  ['1',      '66.242.10.27,255.255.255.0',],
  ['1',      '89.167.203.28,255.255.255.0',],
  ['2',      '195.5.160.22,255.255.255.0',],
  ['2',      '68.169.25.28,255.255.255.0',],
  ['2',      '195.5.160.27,255.255.255.0',],
  ['2',      '66.242.0.15,255.255.255.0',],
  ['2',      '66.242.10.18,255.255.255.0',],
  ['2',      '89.167.201.31,255.255.255.0',],
  ['2',      '68.169.22.8,255.255.255.0',],
  ['2',      '66.242.10.39,255.255.255.0',],
  ['2',      '66.242.10.42,255.255.255.0',],
  ['2',      '89.167.202.47,255.255.255.0',],
  ['2',      '66.242.11.33,255.255.255.0',],
  ['2',      '89.167.203.4,255.255.255.0',],
  ['2',      '68.169.23.31,255.255.255.0',],
  ['2',      '68.169.25.40,255.255.255.0',],
  ['3',      '195.5.160.37,255.255.255.0',],
  ['3',      '66.242.11.38,255.255.255.0',],
  ['3',      '68.169.25.36,255.255.255.0',],
  ['3',      '66.242.0.13,255.255.255.0',],
  ['3',      '195.5.160.18,255.255.255.0',],
  ['3',      '195.5.160.32,255.255.255.0',],
  ['3',      '68.169.22.42,255.255.255.0',],
  ['3',      '89.167.201.38,255.255.255.0',],
  ['3',      '68.169.23.36,255.255.255.0',],
  ['3',      '66.242.11.9,255.255.255.0',],
  ['3',      '66.242.10.37,255.255.255.0',],
  ['3',      '89.167.203.14,255.255.255.0',],
  ['3',      '68.169.22.22,255.255.255.0',],
  ['3',      '66.242.0.35,255.255.255.0',],
  ['4',      '68.169.23.48,255.255.255.0',],
  ['4',      '89.167.202.13,255.255.255.0',],
  ['4',      '195.5.160.44,255.255.255.0',],
  ['4',      '68.169.24.20,255.255.255.0',],
  ['4',      '89.167.203.21,255.255.255.0',],
  ['4',      '89.167.201.36,255.255.255.0',],
  ['4',      '89.167.202.18,255.255.255.0',],
  ['4',      '89.167.201.6,255.255.255.0',],
  ['4',      '66.242.1.19,255.255.255.0',],
  ['4',      '66.242.1.33,255.255.255.0',],
  ['4',      '68.169.24.13,255.255.255.0',],
  ['4',      '195.5.160.3,255.255.255.0',],
  ['4',      '68.169.22.5,255.255.255.0',],
  ['4',      '68.169.25.4,255.255.255.0',],
  ['5',      '195.5.160.20,255.255.255.0',],
  ['5',      '89.167.203.23,255.255.255.0',],
  ['5',      '68.169.24.35,255.255.255.0',],
  ['5',      '89.167.202.27,255.255.255.0',],
  ['5',      '89.167.203.16,255.255.255.0',],
  ['5',      '68.169.22.25,255.255.255.0',],
  ['5',      '68.169.24.8,255.255.255.0',],
  ['5',      '89.167.201.45,255.255.255.0',],
  ['5',      '195.5.160.5,255.255.255.0',],
  ['5',      '66.242.0.3,255.255.255.0',],
  ['5',      '89.167.202.25,255.255.255.0',],
  ['5',      '68.169.24.32,255.255.255.0',],
  ['5',      '68.169.23.6,255.255.255.0',],
  ['5',      '66.242.10.22,255.255.255.0',],
  ['6',      '68.169.23.45,255.255.255.0',],
  ['6',      '66.242.1.16,255.255.255.0',],
  ['6',      '89.167.202.39,255.255.255.0',],
  ['6',      '68.169.23.9,255.255.255.0',],
  ['6',      '89.167.203.11,255.255.255.0',],
  ['6',      '68.169.22.37,255.255.255.0',],
  ['6',      '89.167.201.21,255.255.255.0',],
  ['6',      '66.242.1.45,255.255.255.0',],
  ['6',      '68.169.22.27,255.255.255.0',],
  ['6',      '66.242.11.11,255.255.255.0',],
  ['6',      '66.242.0.20,255.255.255.0',],
  ['6',      '66.242.1.31,255.255.255.0',],
  ['6',      '66.242.11.6,255.255.255.0',],
  ['6',      '66.242.1.14,255.255.255.0',],
  ['7',      '68.169.24.10,255.255.255.0',],
  ['7',      '68.169.22.39,255.255.255.0',],
  ['7',      '89.167.201.11,255.255.255.0',],
  ['7',      '89.167.201.28,255.255.255.0',],
  ['7',      '66.242.10.35,255.255.255.0',],
  ['7',      '68.169.24.47,255.255.255.0',],
  ['7',      '66.242.10.8,255.255.255.0',],
  ['7',      '66.242.10.15,255.255.255.0',],
  ['7',      '66.242.1.6,255.255.255.0',],
  ['7',      '66.242.10.5,255.255.255.0',],
  ['7',      '66.242.1.11,255.255.255.0',],
  ['7',      '68.169.25.9,255.255.255.0',],
  ['7',      '68.169.22.18,255.255.255.0',],
  ['7',      '195.5.160.35,255.255.255.0',],
  ['8',      '66.242.11.26,255.255.255.0',],
  ['8',      '68.169.25.19,255.255.255.0',],
  ['8',      '66.242.10.3,255.255.255.0',],
  ['8',      '68.169.22.44,255.255.255.0',],
  ['8',      '89.167.202.15,255.255.255.0',],
  ['8',      '68.169.25.33,255.255.255.0',],
  ['8',      '68.169.25.43,255.255.255.0',],
  ['8',      '195.5.160.13,255.255.255.0',],
  ['8',      '66.242.0.39,255.255.255.0',],
  ['8',      '68.169.25.6,255.255.255.0',],
  ['8',      '66.242.0.37,255.255.255.0',],
  ['8',      '89.167.203.45,255.255.255.0',],
  ['8',      '66.242.1.48,255.255.255.0',],
  ['8',      '66.242.10.20,255.255.255.0',],
  ['9',      '66.242.0.18,255.255.255.0',],
  ['9',      '66.242.0.27,255.255.255.0',],
  ['9',      '68.169.25.14,255.255.255.0',],
  ['9',      '89.167.201.40,255.255.255.0',],
  ['9',      '66.242.11.14,255.255.255.0',],
  ['9',      '195.5.160.8,255.255.255.0',],
  ['9',      '68.169.25.26,255.255.255.0',],
  ['9',      '68.169.25.16,255.255.255.0',],
  ['9',      '66.242.11.36,255.255.255.0',],
  ['9',      '68.169.22.32,255.255.255.0',],
  ['9',      '195.5.160.30,255.255.255.0',],
  ['9',      '66.242.0.30,255.255.255.0',],
  ['9',      '66.242.11.40,255.255.255.0',],
  ['9',      '66.242.11.21,255.255.255.0',],
  ['10',     '68.169.25.11,255.255.255.0',],
  ['10',     '89.167.201.16,255.255.255.0',],
  ['10',     '68.169.24.3,255.255.255.0',],
  ['10',     '66.242.0.10,255.255.255.0',],
  ['10',     '68.169.24.27,255.255.255.0',],
  ['10',     '66.242.0.22,255.255.255.0',],
  ['10',     '89.167.201.4,255.255.255.0',],
  ['10',     '66.242.10.13,255.255.255.0',],
  ['10',     '66.242.1.21,255.255.255.0',],
  ['10',     '66.242.10.10,255.255.255.0',],
  ['10',     '68.169.23.43,255.255.255.0',],
  ['10',     '68.169.23.33,255.255.255.0',],
  ['10',     '66.242.1.40,255.255.255.0',],
  ['10',     '66.242.0.32,255.255.255.0',],
  ['11',     '68.169.22.30,255.255.255.0',],
  ['11',     '68.169.25.21,255.255.255.0',],
  ['11',     '89.167.202.44,255.255.255.0',],
  ['11',     '68.169.22.13,255.255.255.0',],
  ['11',     '89.167.203.33,255.255.255.0',],
  ['11',     '89.167.203.6,255.255.255.0',],
  ['11',     '195.5.160.10,255.255.255.0',],
  ['11',     '66.242.11.31,255.255.255.0',],
  ['11',     '195.5.160.42,255.255.255.0',],
  ['11',     '89.167.201.33,255.255.255.0',],
  ['11',     '66.242.11.16,255.255.255.0',],
  ['11',     '68.169.25.48,255.255.255.0',],
  ['11',     '89.167.202.32,255.255.255.0',],
  ['11',     '89.167.202.20,255.255.255.0',],
  ['12',     '68.169.22.15,255.255.255.0',],
  ['12',     '89.167.201.48,255.255.255.0',],
  ['12',     '89.167.202.10,255.255.255.0',],
  ['12',     '68.169.23.19,255.255.255.0',],
  ['12',     '66.242.11.4,255.255.255.0',],
  ['12',     '89.167.202.37,255.255.255.0',],
  ['12',     '66.242.10.44,255.255.255.0',],
  ['12',     '89.167.203.36,255.255.255.0',],
  ['12',     '66.242.1.36,255.255.255.0',],
  ['12',     '68.169.23.23,255.255.255.0',],
  ['12',     '195.5.160.15,255.255.255.0',],
  ['12',     '89.167.202.8,255.255.255.0',],
  ['12',     '66.242.11.23,255.255.255.0',],
  ['12',     '89.167.203.26,255.255.255.0',],
  ['13',     '66.242.1.43,255.255.255.0',],
  ['13',     '68.169.22.20,255.255.255.0',],
  ['13',     '66.242.1.28,255.255.255.0',],
  ['13',     '68.169.24.22,255.255.255.0',],
  ['13',     '68.169.24.5,255.255.255.0',],
  ['13',     '89.167.203.19,255.255.255.0',],
  ['13',     '89.167.203.48,255.255.255.0',],
  ['13',     '68.169.23.38,255.255.255.0',],
  ['13',     '68.169.24.42,255.255.255.0',],
  ['13',     '89.167.202.22,255.255.255.0',],
  ['13',     '66.242.10.25,255.255.255.0',],
  ['13',     '66.242.1.23,255.255.255.0',],
  ['13',     '66.242.1.9,255.255.255.0',],
  ['13',     '66.242.10.47,255.255.255.0',],
  ['14',     '68.169.23.40,255.255.255.0',],
  ['14',     '68.169.24.39,255.255.255.0',],
  ['14',     '66.242.0.25,255.255.255.0',],
  ['14',     '89.167.202.42,255.255.255.0',],
  ['14',     '89.167.203.38,255.255.255.0',],
  ['14',     '68.169.24.37,255.255.255.0',],
  ['14',     '66.242.0.47,255.255.255.0',],
  ['14',     '66.242.11.43,255.255.255.0',],
  ['14',     '66.242.1.4,255.255.255.0',],
  ['14',     '89.167.202.35,255.255.255.0',],
  ['14',     '89.167.201.14,255.255.255.0',],
  ['14',     '89.167.201.23,255.255.255.0',],
  ['14',     '66.242.11.48,255.255.255.0',],
  ['14',     '89.167.202.5,255.255.255.0',],
  ['15',     '66.242.11.28,255.255.255.0',],
  ['15',     '68.169.24.30,255.255.255.0',],
  ['15',     '89.167.203.40,255.255.255.0',],
  ['15',     '66.242.10.32,255.255.255.0',],
  ['15',     '195.5.160.47,255.255.255.0',],
  ['15',     '66.242.0.42,255.255.255.0',],
  ['15',     '89.167.201.26,255.255.255.0',],
  ['15',     '68.169.24.44,255.255.255.0',],
  ['15',     '89.167.201.9,255.255.255.0',],
  ['15',     '66.242.11.45,255.255.255.0',],
  ['15',     '66.242.0.5,255.255.255.0',],
  ['15',     '68.169.23.11,255.255.255.0',],
  ['15',     '89.167.202.3,255.255.255.0',],
  ['15',     '68.169.23.14,255.255.255.0',],
  ['16',     '89.167.201.19,255.255.255.0',],
  ['16',     '89.167.202.30,255.255.255.0',],
  ['16',     '66.242.11.19,255.255.255.0',],
  ['16',     '68.169.22.10,255.255.255.0',],
  ['16',     '66.242.1.38,255.255.255.0',],
  ['16',     '66.242.10.30,255.255.255.0',],
  ['16',     '68.169.22.3,255.255.255.0',],
  ['16',     '195.5.160.39,255.255.255.0',],
  ['16',     '89.167.203.43,255.255.255.0',],
  ['16',     '68.169.24.25,255.255.255.0',],
  ['16',     '66.242.0.8,255.255.255.0',],
  ['16',     '68.169.23.4,255.255.255.0',],
  ['16',     '89.167.203.31,255.255.255.0',],
  ['16',     '68.169.24.15,255.255.255.0',],
  ['EXTRA',  '68.169.25.45,255.255.255.0',],
  ['EXTRA',  '195.5.160.25,255.255.255.0',],
  ['EXTRA',  '68.169.23.16,255.255.255.0',],
  ['EXTRA',  '89.167.201.43,255.255.255.0',],
];

var MASKS = {
  '255.255.255.252': 30,
  '255.255.255.248': 29,
  '255.255.255.240': 28,
  '255.255.255.224': 27,
  '255.255.255.192': 26,
  '255.255.255.128': 25,
  '255.255.255.0'  : 24,
  '255.255.254.0'  : 23,
  '255.255.252.0'  : 22,
  '255.255.248.0'  : 21,
  '255.255.240.0'  : 20,
  '255.255.224.0'  : 19,
  '255.255.192.0'  : 18,
  '255.255.128.0'  : 17,
  '255.255.0.0'    : 16,
};

var servers = {
  '1' :    '130c',
  '2' :    '131c',
  '3' :    '132c',
  '4' :    '133c',
  '5' :    '134c',
  '6' :    '135c',
  '7' :    '136c',
  '8' :    '137c',
  '9' :    '138c',
  '10':    '139c',
  '11':    '140c',
  '12':    '141c',
  '13':    '142c',
  '14':    '143c',
  '15':    '144c',
  '16':    '145c',
  'EXTRA': '145c',
};

var assign = function(ips){
  return ips.map(function(ip){
    var serverCode = servers[ip[0]]
    var split = ip[1].split(",");
    var submask = MASKS[split[1]];
    var inet = [split[0],submask].join("/");
    return `SELECT id FROM assign((select id from servers where code = '${serverCode}'),'${inet}');`;
  }).join(' ');
};

exports.up = function(db, callback) {
  db.runSql(assign(DATA),callback);
};

exports.down = function(db, callback) {
  callback();
};
